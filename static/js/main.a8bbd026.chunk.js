(this["webpackJsonpcdp-frontend"]=this["webpackJsonpcdp-frontend"]||[]).push([[0],{357:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=357},458:function(e,t,a){e.exports=a(831)},463:function(e,t,a){},831:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(49),i=a.n(c),o=(a(463),a(148)),l=a(121),u=a(190),s=a(449),m=a(416),d=a(450),p=a(36);function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=function(e){o.a.set(Object(p.a)({page:e},t)),o.a.pageview(e)};return function(t){function n(){return Object(l.a)(this,n),Object(s.a)(this,Object(m.a)(n).apply(this,arguments))}return Object(d.a)(n,t),Object(u.a)(n,[{key:"componentDidMount",value:function(){a(window.location.hash.substr(1))}},{key:"componentDidUpdate",value:function(e){var t=this.props.location.pathname,n=e.location.pathname;t!==n&&a(n)}},{key:"render",value:function(){return r.a.createElement(e,this.props)}}]),n}(n.Component)}var h=a(39),v=a(83),E=a(856),b=a(842),y=a(9),w=y.a.h1({}),g=Object(y.a)("span")({transition:".8s all",borderRadius:"5px",padding:"1rem .5rem",":hover":{backgroundColor:"#F5F5F5",color:"black"}}),x=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{vertical:!0},r.a.createElement(b.a,null,r.a.createElement(h.b,{to:"/"},r.a.createElement(w,null,"Council Data Project")))),r.a.createElement(E.a,{vertical:!0},r.a.createElement(b.a,null,r.a.createElement(h.b,{to:"/events"},r.a.createElement(g,null,"Events")),r.a.createElement(h.b,{to:"/people"},r.a.createElement(g,{style:{marginLeft:"10px"}},"People")))))},O=a(858),j=a(857),S=a(853),C=function(){return r.a.createElement(E.a,{inverted:!0,vertical:!0,style:{padding:"5em 0em"}},r.a.createElement(b.a,null,r.a.createElement(O.a,{inverted:!0,stackable:!0},r.a.createElement(O.a.Row,{columns:"equal"},r.a.createElement(O.a.Column,null,r.a.createElement(j.a,{inverted:!0,as:"h4",content:"About"}),r.a.createElement(S.a,{link:!0,inverted:!0},r.a.createElement(S.a.Item,{as:"a"},"The Project"),r.a.createElement(S.a.Item,{as:"a"},"The Team"),r.a.createElement(S.a.Item,{as:"a"},"Other Work"))),r.a.createElement(O.a.Column,null,r.a.createElement(j.a,{inverted:!0,as:"h4",content:"Seattle"}),r.a.createElement(S.a,{link:!0,inverted:!0},r.a.createElement(S.a.Item,{as:"a"},"City of Seattle"),r.a.createElement(S.a.Item,{as:"a"},"Seattle Open Data"),r.a.createElement(S.a.Item,{as:"a"},"Seattle Channel"))),r.a.createElement(O.a.Column,null,r.a.createElement(j.a,{inverted:!0,as:"h4",content:"Developers"}),r.a.createElement(S.a,{link:!0,inverted:!0},r.a.createElement(S.a.Item,{as:"a"},"Council Data Project"),r.a.createElement(S.a.Item,{as:"a"},"Seattle Specific"),r.a.createElement(S.a.Item,{as:"a"},"Transcription Runner")))),r.a.createElement(O.a.Row,null,r.a.createElement("p",null,"This web application is not funded by, nor associated with the Seattle City Council. This is a prototype web application to show the viability of an automated and collaborativly sourced city council transcription service. The transcripts are roughly ninty-percent accurate, and therefore may not represent what was actually said.")))))},k=a(12),_=a.n(k),R=a(21),A=a(843),P=a(833),I=Object(y.a)(b.a)({minHeight:"100vh"}),D=Object(y.a)(b.a)({marginTop:"2em !important",marginBottom:"5em !important"}),T=Object(y.a)(A.a)({width:"50% !important"}),B=Object(y.a)(O.a)({display:"block",marginTop:"150px !important"}),M=function(e){var t=r.a.useState(""),a=Object(R.a)(t,2),n=a[0],c=a[1];return r.a.createElement(I,null,r.a.createElement(D,null,r.a.createElement(B,{verticalAlign:"middle",centered:!0},r.a.createElement(O.a.Row,null,r.a.createElement("h1",null,"Search City Council Transcripts")),r.a.createElement(O.a.Row,null,r.a.createElement(T,{placeholder:"Enter a keyword to search meeting transcripts",value:n,onChange:function(e,t){var a;return _.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:a=t.value,c(a);case 2:case"end":return e.stop()}}))},onKeyPress:function(t){"Enter"===t.key&&e.history.push({pathname:"/search",search:"?q=".concat(n.trim().replace(/\s+/g,"+")),state:{query:n}})}}),r.a.createElement(P.a,{attached:"right",primary:!0,as:h.b,to:{pathname:"/search",search:"?q=".concat(n.trim().replace(/\s+/g,"+")),state:{query:n}}},"Search")))))},N=a(193),U=a.n(N),q=a(849),F=a(854),L=a(43),V=a.n(L),H=function(e){return V.a.utc(e).format("MMMM D, YYYY h:mm A")},Y=Object(y.a)(F.a)({boxShadow:"none !important"}),z=Object(y.a)(F.a.Content)({padding:"0 !important"}),W=function(e){var t=e.name,a=e.date,n=e.description,c=e.link,i=e.query;return r.a.createElement(Y,{fluid:!0},r.a.createElement(z,null,r.a.createElement(F.a.Header,null,r.a.createElement(h.b,{to:function(){var e=i?i.trim().replace(/\s+/g," "):"";return{pathname:c,search:e?"?q=".concat(e.replace(/\s+/g,"+")):"",state:{query:e}}}()},t)),r.a.createElement(F.a.Meta,null,H(a)),r.a.createElement(F.a.Description,null,n)))},Q=r.a.memo((function(e){var t=e.events,a=e.query;return r.a.createElement(F.a.Group,{centered:!0},t.map((function(e){var t=e.name,n=e.date,c=e.description,i=e.id;return r.a.createElement(W,{key:i,name:t,date:n,description:c,link:"/events/".concat(i),query:a})})))})),G=a(851),J=a(73),K=y.a.div({display:"flex",justifyContent:"space-between",padding:"1em 0"}),Z=Object(y.a)(G.a)({minWidth:"250px !important",maxWidth:"90% !important",boxShadow:"none !important","@media(max-width:500px)":{width:"86% !important"}}),$=Object(y.a)(G.a.Content)({flexGrow:"1",overflowY:"auto !important"}),X=y.a.div({maxHeight:"45vh",display:"flex",flexDirection:"column"}),ee=r.a.memo((function(e){var t=e.filter,a=e.header,n=e.handlePopupClose,c=e.mountNodeRef,i=e.children,o=t.clear,l=t.getTextRep,u=t.isActive,s=r.a.useState(!1),m=Object(R.a)(s,2),d=m[0],p=m[1],f=function(){p(!1),n()};return r.a.createElement(Z,{basic:!0,flowing:!0,mountNode:c.current,on:"click",onClose:f,onOpen:function(){p(!0)},open:d,pinned:!0,offset:"0, -5px",position:"bottom left",positionFixed:!0,trigger:r.a.createElement(P.a,{icon:!0,labelPosition:"right",basic:!u()},r.a.createElement(J.a,{name:"angle down"}),l())},r.a.createElement(X,null,r.a.createElement(j.a,{content:a}),r.a.createElement($,null,i),r.a.createElement(K,null,r.a.createElement(P.a,{size:"mini",onClick:function(){o()}},r.a.createElement(J.a,{name:"remove"})," Clear"),r.a.createElement(P.a,{size:"mini",primary:!0,onClick:f},r.a.createElement(J.a,{name:"checkmark"})," Save"))))})),te=function(e,t){var a=V.a.utc(e.start,"YYYY-MM-DD"),n=V.a.utc(e.end,"YYYY-MM-DD"),r=a.format("MMM D, YYYY"),c=n.format("MMM D, YYYY");return e.start&&e.end?a.year()===n.year()&&a.month()===n.month()?"".concat(r.split(",")[0]," - ").concat(n.date(),", ").concat(n.year()):a.year()===n.year()?"".concat(r.split(",")[0]," - ").concat(c.split(",")[0],", ").concat(n.year()):"".concat(r," - ").concat(c):e.start?"".concat(r," -"):e.end?"- ".concat(c):t},ae=r.a.memo((function(e){var t=e.filter,a=t.value,n=t.handleChange,c=function(e,t){var a=t.name,r=t.value;n(a,r)};return r.a.createElement(q.a,null,r.a.createElement(q.a.Field,null,"From"),r.a.createElement(q.a.Input,{fluid:!0,name:"start",type:"date",onChange:c,value:a.start}),r.a.createElement(q.a.Field,null,"To"),r.a.createElement(q.a.Input,{fluid:!0,name:"end",type:"date",onChange:c,value:a.end}))})),ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return-1!==e.toLowerCase().indexOf(t.toLowerCase())},re=function(e,t){var a=Object.values(e).filter((function(e){return e})).length;return a?"".concat(t," : ").concat(a):t},ce=Object(y.a)(q.a.Input)({paddingRight:".8em"}),ie=r.a.memo((function(e){var t=e.filter,a=e.options,n=e.optionQuery,c=e.setOptionQuery,i=t.filterName,o=t.value,l=t.handleChange,u=function(e,t){var a=t.name,n=t.checked;l(a,n)},s=a;return a.length>5&&(s=a.filter((function(e){var t=e.text;return ne(t,n)}))),r.a.createElement(q.a,null,a.length>5&&r.a.createElement(ce,{placeholder:"Search ".concat(i," Options"),value:n,onChange:function(e,t){var a=t.value;c(a)}}),s.map((function(e){return r.a.createElement(q.a.Checkbox,{key:e.name,label:e.text,name:e.name,checked:o[e.name],onChange:u})})))})),oe=a(100),le=a.n(oe);a(597);function ue(e){return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",fetch(e).then((function(e){return e.json()})));case 1:case"end":return t.stop()}}))}var se={eq:"==",contains:"array-contains",contains_any:"array-contains-any",in:"in",gt:">",lt:"<",gteq:">=",lteq:"<="},me={asc:"asc",desc:"desc"},de=function e(t){Object(l.a)(this,e);var a=new Error("Unsure how to create WhereCondition from received data: ".concat(t));if(t instanceof Array)if(2===t.length)this.columnName=t[0],this.operator=se.eq,this.value=t[1];else{if(3!==t.length)throw a;if(!Object.values(se).includes(t[1]))throw new Error("\n                        Unknown WhereCondition operator: ".concat(t[1],"\n                        Allowed WhereCondition operators: ").concat(Object.values(se),"\n                    "));this.columnName=t[0],this.operator=t[1],this.value=t[2]}else{if(!(t instanceof Object))throw a;if(t.columnName&&t.operator&&t.value){if(!Object.values(se).includes(t.operator))throw new Error("\n                        Unknown WhereCondition operator: ".concat(t.operator,"\n                        Allowed WhereCondition operators: ").concat(Object.values(se),"\n                    "));this.columnName=t.columnName,this.operator=t.operator,this.value=t.value}else{if(!t.columnName||!t.value)throw a;this.columnName=t.columnName,this.operator=se.eq,this.value=t.value}}},pe=function e(t){Object(l.a)(this,e);var a,n=new Error("Unsure how to create OrderCondition from received data: ".concat(t));if("string"===typeof(a=t)||a instanceof String)this.columnName=t,this.operator=me.desc;else if(t instanceof Array)if(1===t.length)this.columnName=t[0],this.operator=me.desc;else{if(2!==t.length)throw n;if(!Object.values(me).includes(t[1]))throw new Error("\n                        Unknown OrderCondition operator: ".concat(t[1],"\n                        Allowed OrderCondition operators: ").concat(Object.values(me),"\n                    "));this.columnName=t[0],this.operator=t[1]}else{if(!(t instanceof Object))throw n;if(t.columnName&&t.operator){if(!Object.values(me).includes(t.operator))throw new Error("\n                        Unknown OrderCondition operator: ".concat(t.operator,"\n                        Allowed OrderCondition operators: ").concat(Object.values(me),"\n                    "));this.columnName=t.columnName,this.operator=t.operator}else{if(!t.columnName)throw n;this.columnName=t.columnName,this.operator=me.desc}}},fe=new(function(){function e(t){Object(l.a)(this,e),this.credentials=t,le.a.initializeApp(this.credentials),this.connection=le.a.firestore()}return Object(u.a)(e,[{key:"selectRowById",value:function(e,t){var a;return _.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_.a.awrap(this.connection.collection(e).doc(t).get());case 3:return a=n.sent,n.abrupt("return",a.data());case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 10:case 11:case"end":return n.stop()}}),null,this,[[0,7]])}},{key:"_unpackQueryResults",value:function(e){var t;return _.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t=[],e.forEach((function(e){var a=e.data(),n=Object(p.a)({id:e.id},a);t.push(n)})),a.abrupt("return",t);case 3:case"end":return a.stop()}}))}},{key:"selectRowsAsArray",value:function(e){var t,a,n,r,c,i=arguments;return _.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=i.length>1&&void 0!==i[1]?i[1]:[],a=i.length>2&&void 0!==i[2]?i[2]:void 0,n=i.length>3&&void 0!==i[3]?i[3]:1e3,o.prev=3,r=this.connection.collection(e),t.forEach((function(e){r=r.where(e.columnName,e.operator,e.value)})),a&&(r=r.orderBy(a.columnName,a.operator)),r=r.limit(n),o.next=11,_.a.awrap(r.get().catch((function(e){throw new Error("Failed to retrieve data from database. Error: ".concat(e))})));case 11:return c=o.sent,o.next=14,_.a.awrap(this._unpackQueryResults(c));case 14:return o.abrupt("return",o.sent);case 17:return o.prev=17,o.t0=o.catch(3),o.abrupt("return",Promise.reject(o.t0));case 20:case 21:case"end":return o.stop()}}),null,this,[[3,17]])}}]),e}())({apiKey:"AIzaSyA7aO6weBcOUBZLmxE3aMyn4NeElVEHZUc",authDomain:"cdp-sea.firebaseapp.com",projectId:"cdp-seattle",databaseURL:"https://cdp-sea.firebaseio.com"}),he=function(e,t){var a,n;if(e.by)switch(e.by){case"name":a="Committee";break;case"date":a="Date";break;case"value":a="Relevance"}e.order&&(n=e.order===me.asc?"Ascending":"Descending");var r=t;return r+=a&&n?" by ".concat(a,": ").concat(n):a?" by ".concat(a):n?" ".concat(n):" By"},ve=r.a.memo((function(e){var t=e.filter,a=e.sortByOptions,n=t.value,c=t.handleChange,i=function(e,t){var a=t.name,n=t.value;c(a,n)};return r.a.createElement(q.a,null,r.a.createElement(q.a.Field,null,"Sort By"),a.map((function(e){return r.a.createElement(q.a.Checkbox,{key:e.value,radio:!0,label:e.label,name:"by",value:e.value,checked:n.by===e.value,onChange:i})})),r.a.createElement(q.a.Field,null,"Sort Order"),r.a.createElement(q.a.Checkbox,{radio:!0,label:"Ascending",name:"order",value:me.asc,checked:n.order===me.asc,onChange:i}),r.a.createElement(q.a.Checkbox,{radio:!0,label:"Descending",name:"order",value:me.desc,checked:n.order===me.desc,onChange:i}))})),Ee=(a(832),a(432)),be=a.n(Ee),ye=a(41),we=a.n(ye),ge=le.a.storage();function xe(){var e;return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_.a.awrap(fe.selectRowsAsArray("event",[],new pe(["event_datetime",me.desc])));case 3:return e=t.sent,t.next=6,_.a.awrap(De(e));case 6:return t.abrupt("return",t.sent);case 9:return t.prev=9,t.t0=t.catch(0),t.abrupt("return",Promise.reject(t.t0));case 12:case"end":return t.stop()}}),null,null,[[0,9]])}function Oe(e,t){var a;return _.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_.a.awrap(fe.selectRowsAsArray("event_minutes_item",[new de(["event_id",se.eq,e])],new pe(["index",t])));case 3:return a=n.sent,n.abrupt("return",a);case 7:return n.prev=7,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 10:case 11:case"end":return n.stop()}}),null,null,[[0,7]])}function je(e){var t,a;return _.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,_.a.awrap(fe.selectRowById("minutes_item",e.minutes_item_id));case 3:return t=n.sent,n.next=6,_.a.awrap(fe.selectRowsAsArray("minutes_item_file",[new de(["minutes_item_id",se.eq,e.minutes_item_id])],new pe(["name",me.asc])));case 6:return a=n.sent,n.abrupt("return",Object(p.a)({},e,{minutes_item:Object(p.a)({id:e.minutes_item_id},t,{file:a})}));case 10:return n.prev=10,n.t0=n.catch(0),n.abrupt("return",Promise.reject(n.t0));case 13:case 14:case"end":return n.stop()}}),null,null,[[0,10]])}function Se(e){var t;return _.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,_.a.awrap(fe.selectRowById("body",e));case 3:return t=a.sent,a.abrupt("return",t);case 7:return a.prev=7,a.t0=a.catch(0),a.abrupt("return",Promise.reject(a.t0));case 10:case"end":return a.stop()}}),null,null,[[0,7]])}function Ce(e){var t,a,n,r,c,i;return _.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,_.a.awrap(fe.selectRowsAsArray("transcript",[new de(["event_id",se.eq,e])]));case 3:return t=o.sent,a=Object(R.a)(t,1),n=a[0],o.next=8,_.a.awrap(fe.selectRowById("file",n.file_id));case 8:return r=o.sent,c=ge.refFromURL(r.uri),o.next=12,_.a.awrap(c.getDownloadURL().then((function(e){return ue(e)})));case 12:return i=o.sent,o.abrupt("return",i);case 16:return o.prev=16,o.t0=o.catch(0),o.abrupt("return",Promise.reject(o.t0));case 19:case"end":return o.stop()}}),null,null,[[0,16]])}function ke(e){var t,a,n,r,c;return _.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.filter((function(e){return null!==e.decision})),a=[],t.forEach((function(e){a.push({matter:e.minutes_item.matter,name:e.minutes_item.name,id:e.id,decision:e.decision,index:e.index})})),n=a.map((function(e){return fe.selectRowsAsArray("vote",[new de(["event_minutes_item_id",se.eq,e.id])])})),i.next=6,_.a.awrap(Promise.all(n));case 6:return r=i.sent,i.next=9,_.a.awrap(fe.selectRowsAsArray("person"));case 9:return c=i.sent,a.forEach((function(e,t){var a=r[t],n=[];a.forEach((function(e){var t=c.find((function(t){return t.id===e.person_id}));n.push({decision:e.decision,person_id:e.person_id,full_name:t.full_name})})),e.formattedIndividualVotes=Object(ye.sortBy)(n,(function(e){return e.full_name}))})),i.abrupt("return",a);case 12:case"end":return i.stop()}}))}function _e(e){var t,a,n,r,c,i;return _.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,_.a.awrap(fe.selectRowById("event",e));case 3:return t=o.sent,o.next=6,_.a.awrap(Se(t.body_id));case 6:return a=o.sent,o.next=9,_.a.awrap(Oe(e,me.asc));case 9:return n=o.sent,o.next=12,_.a.awrap(Promise.all(n.map((function(e){return je(e)}))));case 12:return r=o.sent,o.next=15,_.a.awrap(Ce(e));case 15:return c=o.sent,o.next=18,_.a.awrap(ke(r));case 18:return i=o.sent,o.abrupt("return",{id:e,name:a.name,description:a.description,videoUrl:t.video_uri,date:V.a.utc(t.event_datetime.toMillis()).toISOString(),minutes:r,transcript:c.data,scPageUrl:t.source_uri,votes:i});case 22:return o.prev=22,o.t0=o.catch(0),o.abrupt("return",Promise.reject(o.t0));case 25:case"end":return o.stop()}}),null,null,[[0,22]])}function Re(e){var t,a,n,r,c,i,o,l,u,s=arguments;return _.a.async((function(m){for(;;)switch(m.prev=m.next){case 0:if(t=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2&&void 0!==s[2]?s[2]:[],n=s.length>3&&void 0!==s[3]?s[3]:{},r=0,m.prev=4,be.a.PorterStemmer.attach(),0!==(c=e.tokenizeAndStem()).length){m.next=9;break}return m.abrupt("return",[]);case 9:return m.next=11,_.a.awrap(Promise.all(c.map((function(e){return fe.selectRowsAsArray("indexed_event_term",[new de(["term",se.eq,e])])}))));case 11:return i=m.sent,o=Object(ye.mapValues)(Object(ye.groupBy)(Object(ye.flatten)(i),(function(e){return e.event_id})),(function(e,t){return e.reduce((function(e,t){return Object(p.a)({},e,{value:e.value+t.value})}),{event_id:t,value:0})})),l=Object(ye.filter)(o,(function(e){return e.value>r})),m.next=16,_.a.awrap(Promise.all(l.map((function(e){var t=e.event_id;return fe.selectRowById("event",t)}))));case 16:return u=m.sent,m.next=19,_.a.awrap(De(u));case 19:return(u=m.sent).forEach((function(e,t){e.id=l[t].event_id,e.value=l[t].value})),u=Be(u=Te(u,t,a),n,!0),m.abrupt("return",u);case 26:return m.prev=26,m.t0=m.catch(4),m.abrupt("return",Promise.reject(m.t0));case 29:case"end":return m.stop()}}),null,null,[[4,26]])}function Ae(){return _.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",fe.selectRowsAsArray("body",[],new pe(["name",me.asc])));case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 7:case"end":return e.stop()}}),null,null,[[0,4]])}function Pe(e,t,a){var n,r;return _.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,n=[],t.length?t.forEach((function(t){return n.push(Ie(e,t))})):n.push(Ie(e)),c.t0=ye.flatten,c.next=6,_.a.awrap(Promise.all(n));case 6:return c.t1=c.sent,r=(0,c.t0)(c.t1),c.next=10,_.a.awrap(De(r));case 10:return r=Be(r=c.sent,a),c.abrupt("return",r);case 15:return c.prev=15,c.t2=c.catch(0),c.abrupt("return",Promise.reject(c.t2));case 18:case"end":return c.stop()}}),null,null,[[0,15]])}function Ie(e){var t,a,n,r,c,i,o=arguments;return _.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return t=o.length>1&&void 0!==o[1]?o[1]:null,a=[],t&&a.push(new de(["body_id",se.eq,t])),e.start&&(n=V.a.utc(e.start,"YYYY-MM-DD"),r=le.a.firestore.Timestamp.fromMillis(n.valueOf()),a.push(new de(["event_datetime",se.gteq,r]))),e.end&&(c=V.a.utc(e.end,"YYYY-MM-DD").add(1,"days").subtract(1,"milliseconds"),i=le.a.firestore.Timestamp.fromMillis(c.valueOf()),a.push(new de(["event_datetime",se.lteq,i]))),l.abrupt("return",fe.selectRowsAsArray("event",a));case 6:case"end":return l.stop()}}))}function De(e){var t;return _.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_.a.awrap(Ae());case 2:return t=a.sent,a.abrupt("return",e.map((function(e){var a=t.find((function(t){return t.id===e.body_id}));return{id:e.id,body_id:a.id,name:a.name,description:a.description,date:V.a.utc(e.event_datetime.toMillis()).toISOString()}})));case 4:case"end":return a.stop()}}))}function Te(e,t,a){return e.filter((function(e){if(a.length&&-1===a.indexOf(e.body_id))return!1;if(t.start&&V.a.utc(e.date).isBefore(V.a.utc(t.start)))return!1;if(t.end){var n=V.a.utc(t.end,"YYYY-MM-DD").add(1,"days").subtract(1,"milliseconds");if(V.a.utc(e.date).isAfter(n))return!1}return!0}))}function Be(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e=t.by&&t.order?Object(ye.orderBy)(e,[t.by],[t.order]):Object(ye.orderBy)(e,[a?"value":"date"],[me.desc])}function Me(){var e;return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.awrap(fe.selectRowsAsArray("person",[],new pe(["full_name",me.asc])));case 2:return e=t.sent,t.abrupt("return",e);case 4:case"end":return t.stop()}}))}function Ne(e){var t,a,n,r,c,i,o,l,u,s,m;return _.a.async((function(d){for(;;)switch(d.prev=d.next){case 0:return t=[],d.next=3,_.a.awrap(fe.selectRowById("person",e));case 3:return a=d.sent,d.next=6,_.a.awrap(fe.selectRowsAsArray("vote",[new de(["person_id",se.eq,e])]));case 6:return n=d.sent,r=n.map((function(e){return fe.selectRowById("event_minutes_item",e.event_minutes_item_id)})),d.next=10,_.a.awrap(Promise.all(r));case 10:return c=d.sent,i=c.map((function(e){return fe.selectRowById("minutes_item",e.minutes_item_id)})),d.next=14,_.a.awrap(Promise.all(i));case 14:return o=d.sent,l=c.map((function(e){return fe.selectRowById("event",e.event_id)})),d.next=18,_.a.awrap(Promise.all(l));case 18:return u=d.sent,d.next=21,_.a.awrap(fe.selectRowsAsArray("body"));case 21:return s=d.sent,n.forEach((function(e,a){var n=c[a],r=o[a],i=u[a],l=s.find((function(e){return e.id===i.body_id})),m={id:e.id,matter:r.matter,name:r.name,voteForPerson:e.decision,decision:n.decision,eventId:n.event_id,index:n.index,eventDate:V.a.utc(i.event_datetime.toMillis()).toISOString(),body_name:l.name};t.push(m)})),m=Object(ye.orderBy)(t,["eventDate","index"],["desc","desc"]),d.abrupt("return",Object(p.a)({},a,{votes:m}));case 25:case"end":return d.stop()}}))}var Ue=r.a.memo((function(e){var t=e.filters,a=e.handlePopupClose,n=e.sortByOptions,c=r.a.useRef(),i=r.a.useState([]),o=Object(R.a)(i,2),l=o[0],u=o[1],s=Object(R.a)(t,3),m=s[0],d=s[1],p=s[2],f=r.a.useState(""),h=Object(R.a)(f,2),v=h[0],E=h[1];return r.a.useEffect((function(){var e=!1;return function(){var t;_.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_.a.awrap(Ae());case 2:t=a.sent,e||u(t);case 4:case"end":return a.stop()}}))}(),function(){e=!0}}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(ee,{filter:m,header:"Select Committees",handlePopupClose:a,mountNodeRef:c},r.a.createElement(ie,{filter:m,options:l.map((function(e){return{name:e.id,text:e.name}})),optionQuery:v,setOptionQuery:E})),r.a.createElement(ee,{filter:d,header:"Select Date Range",handlePopupClose:a,mountNodeRef:c},r.a.createElement(ae,{filter:d})),r.a.createElement(ee,{filter:p,header:"Select Sorting",handlePopupClose:a,mountNodeRef:c},r.a.createElement(ve,{filter:p,sortByOptions:n})),r.a.createElement("div",{ref:c}))}));var qe=function(e){r.a.useEffect((function(){return document.title=e,function(){document.title="Council Data Project - Seattle"}}),[e])},Fe=a(191);function Le(e){return Object.keys(e).filter((function(t){return e[t]}))}var Ve=function(e,t,a,n){var c=r.a.useState(e),i=Object(R.a)(c,2),o=i[0],l=i[1],u=function(){return Object.values(o).some((function(e){return e!==a}))};return{filterName:t,value:o,set:l,clear:function(){l((function(e){var t=Object(p.a)({},e);return Object.keys(t).forEach((function(e){return t[e]=a})),t}))},handleChange:function(e,t){l((function(a){return Object(p.a)({},a,Object(Fe.a)({},e,t))}))},getTextRep:function(){return n(o,t)},isActive:u,isSameValue:function(e){if(!e)return!u();for(var t,a=0,n=Object.keys(o);a<n.length;a++){if(t=n[a],o[t]&&!e.hasOwnProperty(t))return!1;if(o[t]!==e[t]&&e.hasOwnProperty(t))return!1}return!0}}},He=y.a.div({position:"sticky",top:"0",backgroundColor:"white",zIndex:"1",padding:"1em 0 2em","> .ui.button":{marginBottom:"0.5em","@media(max-width:500px)":{width:"100%"}}}),Ye=y.a.span({display:"block",color:"grey",marginBottom:"2em"}),ze=y.a.span({color:"grey",fontWeight:"700",fontSize:"1.5em",marginTop:"1em"}),We=y.a.div({paddingLeft:"1em"}),Qe=function(e){e.query;var t=r.a.useState(!1),a=Object(R.a)(t,2),n=a[0],c=a[1],i=r.a.useState(!0),o=Object(R.a)(i,2),l=o[0],u=o[1],s=r.a.useState([]),m=Object(R.a)(s,2),d=m[0],p=m[1],f=Ve({start:"",end:""},"Date","",te),h=Ve({},"Committee",!1,re),v=Ve({by:"",order:""},"Sort","",he);qe("Committee Events"),r.a.useEffect((function(){var e=!1;return function(){var t;_.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_.a.awrap(xe());case 2:t=a.sent,e||(p(t),c(!0));case 4:case"end":return a.stop()}}))}(),function(){e=!0}}),[]);var E=r.a.useRef(),b=r.a.useRef(),y=r.a.useRef();return r.a.createElement(r.a.Fragment,null,r.a.createElement(He,null,r.a.createElement(Ue,{filters:[h,f,v],handlePopupClose:function(){var e;return _.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:if(h.isSameValue(E.current)&&f.isSameValue(b.current)&&v.isSameValue(y.current)){t.next=12;break}return window.scroll(0,0),u(!1),p([]),t.next=6,_.a.awrap(Pe(f.value,Le(h.value),v.value));case 6:e=t.sent,p(e),E.current=h.value,b.current=f.value,y.current=v.value,u(!0);case 12:case"end":return t.stop()}}))},sortByOptions:[{label:"Committee",value:"name"},{label:"Date",value:"date"}]})),r.a.createElement(We,null,n&&l?r.a.createElement(Ye,null,d.length," results"):r.a.createElement(ze,null,"Loading..."),r.a.createElement(Q,{events:d})))},Ge=function(e){var t=e.query,a=e.filterValues,n=Object(R.a)(a,3),c=n[0],i=n[1],o=n[2],l=r.a.useState(!1),u=Object(R.a)(l,2),s=u[0],m=u[1],d=r.a.useState(t),p=Object(R.a)(d,2),f=p[0],h=p[1],E=r.a.useState([]),b=Object(R.a)(E,2),y=b[0],w=b[1],g=Ve(i,"Date","",te),x=Ve(c,"Committee",!1,re),O=Ve(o,"Sort","",he);qe("Search - ".concat(f));var j=Object(v.f)();r.a.useEffect((function(){var e=!1;return function(){var a;_.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,_.a.awrap(Re(t,i,Le(c),o));case 2:a=n.sent,e||(w(a),m(!0));case 4:case"end":return n.stop()}}))}(),function(){e=!0}}),[t,c,i,o]);var S=r.a.useRef(),C=r.a.useRef(),k=r.a.useRef(),A=r.a.useRef(t),I=function(){x.isSameValue(S.current)&&g.isSameValue(C.current)&&O.isSameValue(k.current)&&A.current===f||(window.scroll(0,0),m(!1),w([]),S.current=x.value,C.current=g.value,k.current=O.value,A.current=f,j.replace({pathname:"/search",search:"?q=".concat(f.trim().replace(/\s+/g,"+")),state:{query:f,committeeFilterValue:x.value,dateRangeFilterValue:g.value,sortFilterValue:O.value}}))};return r.a.createElement(r.a.Fragment,null,r.a.createElement(He,null,r.a.createElement(q.a,{onSubmit:function(e){e.preventDefault(),I()}},r.a.createElement(q.a.Group,{widths:"2"},r.a.createElement(q.a.Input,{placeholder:"Enter a keyword to search meeting transcripts",action:r.a.createElement(P.a,{type:"submit",primary:!0},"Search"),value:f,onChange:function(e,t){var a=t.value;h(a)}}))),r.a.createElement(Ue,{filters:[x,g,O],handlePopupClose:I,sortByOptions:[{label:"Committee",value:"name"},{label:"Date",value:"date"},{label:"Relevance ",value:"value"}]})),r.a.createElement(We,null,s?r.a.createElement(Ye,null,y.length," results"):r.a.createElement(ze,null,"Loading..."),r.a.createElement(Q,{events:y,query:A.current})))},Je=Object(y.a)(b.a)({minHeight:"100vh"}),Ke=Object(y.a)(b.a)({marginTop:"2em !important",marginBottom:"5em !important"}),Ze=function(e){var t=e.location,a=U.a.parse(t.search).q,n=a?a.trim().replace(/\+/g," "):"",c={},i={start:"",end:""},o={by:"",order:""};return t.state&&(n=t.state.query||n,c=t.state.committeeFilterValue||c,i=t.state.dateRangeFilterValue||i,o=t.state.sortFilterValue||o),r.a.createElement(Je,null,r.a.createElement(Ke,null,r.a.createElement(Ge,{query:n,filterValues:[c,i,o]})))},$e=a(848),Xe=a(86),et=a(437),tt=a.n(et);var at=function(e){e=parseInt(e,10);var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;return t<10&&(t="0"+t),a<10&&(a="0"+a),n<10&&(n="0"+n),t+":"+a+":"+n},nt=y.a.div({display:"flex",flexWrap:"wrap",alignItems:"center",margin:"1em 0",padding:"0.2em"}),rt=y.a.div((function(e){return{width:e.isSearch?"100%":"85%",order:e.isSearch?"0":"1",boxSizing:"border-box",fontSize:"16px",lineHeight:"1.5em","@media(max-width:720px)":{width:"100%",order:"0"}}})),ct=y.a.div((function(e){return{width:e.isSearch?"100%":"15%",order:e.isSearch?"1":"0",boxSizing:"border-box",padding:e.isSearch?"0":"0.5em","@media(max-width:720px)":{width:"100%",padding:"0",order:"1"}}})),it=r.a.memo((function(e){var t=e.searchText,a=e.transcript,n=e.handleSeek,c=e.isSearch,i=r.a.useRef(null),o=new Xe.c({fixedWidth:!0,defaultHeight:100});r.a.useEffect((function(){var e=function(){i.current&&i.current.updatePosition()};return document.addEventListener("update-scroll-position",e),function(){document.removeEventListener("update-scroll-position",e)}}),[]);var l=function(){o.clearAll()},u=function(e){var i=e.index,l=e.parent,u=e.key,s=e.style;return r.a.createElement(Xe.b,{key:u,cache:o,parent:l,columnIndex:0,rowIndex:i},r.a.createElement("div",{style:s},r.a.createElement(nt,null,r.a.createElement(ct,{isSearch:c},r.a.createElement(P.a,{size:"tiny",onClick:function(){return n(a[i].start_time)}},r.a.createElement(J.a,{name:"play"}),at(a[i].start_time))),r.a.createElement(rt,{isSearch:c},r.a.createElement(tt.a,{searchWords:[t],autoEscape:!0,textToHighlight:a[i].text})))))};return c?r.a.createElement(Xe.a,{onResize:l},(function(e){var t=e.width,n=e.height;return r.a.createElement(Xe.d,{deferredMeasurementCache:o,height:n,rowCount:a.length,rowHeight:o.rowHeight,rowRenderer:u,scrollToIndex:0,style:{willChange:""},width:t})})):r.a.createElement(Xe.e,{ref:i},(function(e){var t=e.height,n=e.isScrolling,c=e.onChildScroll,i=e.scrollTop;return r.a.createElement(Xe.a,{disableHeight:!0,onResize:l},(function(e){var l=e.width;return r.a.createElement(Xe.d,{autoHeight:!0,deferredMeasurementCache:o,height:t,isScrolling:n,onScroll:c,rowCount:a.length,rowHeight:o.rowHeight,rowRenderer:u,scrollTop:i,style:{willChange:""},width:l})}))}))})),ot=y.a.div({margin:"1em 0",width:"100%",display:"flex",flexDirection:"column",boxSizing:"border-box","@media (min-aspect-ratio:5/4), (min-width:1200px)":{width:"40%",margin:"0"}}),lt=y.a.h2({width:"100%"}),ut=Object(y.a)(A.a)({width:"100%",fontSize:"16px !important",lineHeight:"1.5 !important"}),st=y.a.span({display:"block",marginTop:"1em",color:"grey",paddingLeft:"15px"}),mt=y.a.span({display:"block",marginTop:"1em",fontSize:"16px !important",lineHeight:"1.5 !important",paddingLeft:"15px"}),dt=y.a.div({marginTop:"1em",border:"1px solid lightgray",borderRadius:"0.28rem",boxSizing:"border-box",minHeight:"calc(.5625 * 90vw)","@media (min-aspect-ratio:5/4), (min-width:1200px)":{flex:"1 1 auto",minHeight:"0"}}),pt=function(e){var t=e.transcript,a=e.handleSeek,n=e.mediaQueriesMatches,c=e.query,i=r.a.useState(c),o=Object(R.a)(i,2),l=o[0],u=o[1],s=t.filter((function(e){var t=e.text;return ne(t,l)}));return r.a.createElement(ot,null,r.a.createElement(lt,null,"Search Transcript"),r.a.createElement(ut,{onChange:function(e,t){var a=t.value;u(a),n||document.dispatchEvent(new CustomEvent("update-scroll-position"))},value:l,placeholder:"Search transcript"}),""!==l&&r.a.createElement(st,null,s.length," results"),""!==l&&s.length>0&&r.a.createElement(dt,null,r.a.createElement(it,{searchText:l,transcript:s,handleSeek:a,isSearch:!0})),""===l&&r.a.createElement(mt,null,"Enter a search term to get results."))},ft=a(850),ht=a(265),vt=Object(y.a)(A.a)((function(e){return{borderBottomColor:e.disabled?"white":"black",borderBottomStyle:"solid",borderBottomWidth:"1.5px",width:"10em"}})),Et=Object(y.a)(ft.a)({"i.close":{top:"0 !important",right:"0 !important",color:"black !important"}}),bt=Object(n.forwardRef)((function(e,t){return r.a.createElement(ht.a,{innerRef:t},r.a.createElement(P.a,e))})),yt=Object(y.a)(bt)({backgroundColor:"white !important","i.share":{paddingRight:"1.5em"}}),wt=y.a.div({display:"inline-block"}),gt=function(e){var t=e.trim().split(":").reverse(),a=0;return t.forEach((function(e,t){(e=e.trim())&&(isNaN(e)||e.includes("-")?a+=NaN:a+=parseFloat(e)*Math.pow(60,t))})),a&&(a=Math.floor(a)),a},xt=function(e){if(isNaN(e))return"INVALID TIME POINT";e=Math.floor(parseFloat(e));var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=e-3600*t-60*a;n<10&&(n="0".concat(n)),t>0&&a<10&&(a="0".concat(a));var r="".concat(a,":").concat(n);return t&&(r="".concat(t,":").concat(r)),r},Ot={value:"",isDisabled:!1,isActive:!1},jt=function(e,t){switch(t.type){case"UPDATE_VALUE":return Object(p.a)({},e,{value:t.payload.value});case"VALIDATE_VALUE":var a=xt(gt(e.value));return Object(p.a)({},e,{value:a});case"UPDATE_ISDISABLED":return Object(p.a)({},e,{isDisabled:t.payload.isDisabled});case"UPDATE_ISACTIVE":return Object(p.a)({},e,{isActive:t.payload.isActive});default:return e}},St=function(e){var t=e.videoPlayerRef,a=Object(n.useRef)(),c=Object(n.useRef)(),i=Object(n.useRef)(),o=Object(v.g)(),l=Object(n.useState)(!1),u=Object(R.a)(l,2),s=u[0],m=u[1],d=Object(n.useReducer)(jt,Ot),p=Object(R.a)(d,2),f=p[0],h=p[1],E=function(){h({type:"VALIDATE_VALUE"})};return r.a.createElement(n.Fragment,null,r.a.createElement(Et,{closeIcon:!0,trigger:r.a.createElement(yt,{compact:!0,icon:!0,onClick:function(){var e;if(t.current){var a=t.current.getState().player;e=4===a.readyState?a.currentTime:0}else e=0;h({type:"UPDATE_VALUE",payload:{value:xt(e)}}),h({type:"UPDATE_ISDISABLED",payload:{isDisabled:!1}}),h({type:"UPDATE_ISACTIVE",payload:{isActive:!1}}),m(!0)}},r.a.createElement(J.a,{name:"share"}),"SHARE"),open:s,onClose:function(){i.current.inputRef.current.removeEventListener("blur",E),m(!1)},mountNode:a.current,onMount:function(){i.current.inputRef.current.addEventListener("blur",E)},size:"small"},r.a.createElement(ft.a.Header,null,"Share"),r.a.createElement(ft.a.Content,null,r.a.createElement(A.a,{fluid:!0,action:r.a.createElement(P.a,{primary:!0,content:"Copy",onClick:function(){c.current.select(),document.execCommand("copy")}}),ref:c,value:function(){var e=gt(f.value),t="".concat(document.location.origin,"/#").concat(o.pathname);return f.isActive&&e?"".concat(t,"?t=").concat(e):"".concat(t)}()}),r.a.createElement("br",null),r.a.createElement(q.a,{onSubmit:E},r.a.createElement(q.a.Group,null,r.a.createElement(q.a.Checkbox,{label:"Start at",checked:f.isActive,onChange:function(e,t){var a=t.checked;h({type:"VALIDATE_VALUE"}),h({type:"UPDATE_ISDISABLED",payload:{isDisabled:!a}}),h({type:"UPDATE_ISACTIVE",payload:{isActive:a}})}}),r.a.createElement(vt,{disabled:f.isDisabled,transparent:!0,value:f.value,onChange:function(e,t){var a=t.value;h({type:"UPDATE_VALUE",payload:{value:a}})},ref:i}))))),r.a.createElement(wt,{ref:a}))},Ct=a(855),kt=a(846),_t=y.a.ol({listStylePosition:"outside",paddingLeft:"1.5em"}),Rt=y.a.div({fontSize:"1em",fontWeight:"500"}),At=y.a.div({fontSize:"0.95em"}),Pt=y.a.ul({listStylePosition:"outside",listStyleType:"disc",paddingLeft:"2em"}),It=function(e){var t=e.minutes,a=e.scPageUrl;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,"Minutes"),r.a.createElement(_t,null,t.map((function(e){var t=e.minutes_item;return r.a.createElement("li",{key:t.id},r.a.createElement(Rt,null,t.matter?t.matter:t.name),t.matter&&t.matter!==t.name&&r.a.createElement(At,null,t.name),t.file.length>0&&r.a.createElement(Pt,null,t.file.map((function(e){var t=e.id,a=e.name,n=e.uri;return r.a.createElement("li",{key:t},r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:n},a))}))))}))),r.a.createElement("h3",null,"Links"),r.a.createElement("a",{href:a},"Seattle Channel Event Page"))},Dt=a(852),Tt=[{accessor:"matter",text:"Matter",width:"2"},{accessor:"decision",text:"Decision",width:"1"},{accessor:"name",text:"Name",width:"6"},{accessor:"votingRecords",text:"Vote",width:"5"}],Bt=Object(y.a)("div")({display:"flex"}),Mt=Object(y.a)("div")({width:"70%"}),Nt=Object(y.a)("div")({width:"30%"}),Ut=Object(y.a)(Dt.a.Header)({"@media(max-width:767px)":{display:"none !important"}}),qt=function(e){var t=e.votingData,a=e.isPerson;return r.a.createElement(Dt.a,{striped:!0},r.a.createElement(Ut,null,r.a.createElement(Dt.a.Row,null,Tt.map((function(e){return r.a.createElement(Dt.a.HeaderCell,{key:e.text},e.text)})),a&&r.a.createElement(Dt.a.HeaderCell,{key:"Event"},"Event"))),r.a.createElement(Dt.a.Body,null,t.map((function(e){return r.a.createElement(Dt.a.Row,{key:e.id},Tt.map((function(t){return"votingRecords"!==t.accessor?r.a.createElement(Dt.a.Cell,{key:t.accessor,width:t.width},e[t.accessor]):e.formattedIndividualVotes?r.a.createElement(Dt.a.Cell,{key:t.accessor,width:t.width},e.formattedIndividualVotes.map((function(e){return r.a.createElement(Bt,{key:e.full_name},r.a.createElement(Mt,null,r.a.createElement(h.b,{to:"/people/".concat(e.person_id)},e.full_name)),r.a.createElement(Nt,null,e.decision))}))):r.a.createElement(r.a.Fragment,{key:t.accessor},r.a.createElement(Dt.a.Cell,{singleLine:!0},e.voteForPerson),r.a.createElement(Dt.a.Cell,null,r.a.createElement(h.b,{to:"/events/".concat(e.eventId)},r.a.createElement("span",null,e.body_name)),r.a.createElement("div",null,H(e.eventDate))))})))}))))},Ft=y.a.div({margin:"1em 0",width:"100%",fontSize:"16px",lineHeight:"1.5","a.item":{fontSize:"1.3em !important"}}),Lt=Object(y.a)(Ct.a)({borderBottom:"0 !important",marginBottom:"1em !important",paddingTop:"1em !important",backgroundColor:"white !important",zIndex:"0 !important",width:"100%"}),Vt=r.a.memo((function(e){var t=e.minutes,a=e.scPageUrl,n=e.transcript,c=e.votes,i=e.handleSeek,o=e.topOffset,l=e.mediaQueriesMatches,u=r.a.useState("details"),s=Object(R.a)(u,2),m=s[0],d=s[1],p=r.a.useRef(null);r.a.useEffect((function(){p.current.getBoundingClientRect().top<0&&(p.current.scrollIntoView(!0),l||window.scrollBy(0,-o))}),[m,l,o]);var f=function(e,t){var a=t.name;d(a)};return r.a.createElement(Ft,{ref:p},r.a.createElement(kt.a,{context:p,offset:o,styleElement:{zIndex:"1"}},r.a.createElement(Lt,{secondary:!0,pointing:!0},r.a.createElement(Ct.a.Item,{active:"details"===m,name:"details",onClick:f}),r.a.createElement(Ct.a.Item,{active:"transcript"===m,name:"transcript",onClick:f}),r.a.createElement(Ct.a.Item,{active:"votes"===m,name:"votes",onClick:f}))),{details:r.a.createElement(It,{minutes:t,scPageUrl:a}),transcript:r.a.createElement(it,{searchText:"",transcript:n,handleSeek:i,isSearch:!1}),votes:c.length?r.a.createElement(qt,{votingData:c}):r.a.createElement("div",null,"No votes found for this event.")}[m])})),Ht=a(847),Yt=a(123);var zt=function(e){var t=Object(n.useState)((function(){return matchMedia(e).matches})),a=Object(R.a)(t,2),r=a[0],c=a[1];return Object(n.useEffect)((function(){var t=matchMedia(e),a=function(e){c(e.matches)};return t.addListener(a),function(){t.removeListener(a)}}),[e]),r},Wt=(a(830),y.a.div({display:"flex",flexWrap:"wrap",justifyContent:"space-between"})),Qt=y.a.div({width:"100%",margin:"1em 0"}),Gt=y.a.span({margin:"0.1em 0",color:"grey",fontWeight:"400"}),Jt=Object(y.a)(E.a.Inline)({display:"flex",justifyContent:"space-between",width:"100%","@media (min-aspect-ratio:5/4), (min-width:1200px)":{width:"59%"}}),Kt=y.a.div({position:"absolute",left:"0",right:"0",visibility:"hidden",height:"90px",backgroundColor:"yellow"}),Zt=y.a.div((function(e){return{position:"relative",display:"none","@media (min-aspect-ratio:5/4), (min-width:1200px)":{display:e.isFixed?"block":"none",width:"59%"}}})),$t=y.a.div({position:"absolute",top:"0",left:"0",backgroundColor:"black",height:"100%",width:"100%"}),Xt=y.a.div((function(e){return{width:"100%",position:"sticky",top:"0",zIndex:"2","@media (min-aspect-ratio:5/4), (min-width:1200px)":{position:e.isFixed?"fixed":"relative",width:e.isFixed?"20vw":"59%",right:"0"}}})),ea=y.a.div({position:"relative",paddingTop:"56.25%"}),ta=function(e){e.id;var t=e.title,a=e.date,n=e.minutes,c=e.scPageUrl,i=e.videoUrl,o=e.transcript,l=e.votes,u=e.query,s=e.videoTimePoint,m=r.a.useRef(null),d=r.a.useState(!1),p=Object(R.a)(d,2),f=p[0],h=p[1],v=zt("(min-aspect-ratio:5/4), (min-width:1200px)"),b=r.a.useState(0),y=Object(R.a)(b,2),w=y[0],g=y[1];r.a.useEffect((function(){var e=m.current.video.video;e.disablePictureInPicture=!0,g(e.offsetHeight)}),[]),r.a.useEffect((function(){var e=function(){var e=m.current.video.video;g(e.offsetHeight)};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}),[]);var x=function(e){m.current.seek(parseFloat(e));var t=m.current.getState().player;!t.paused&&t.hasStarted||m.current.play()};return r.a.createElement(Wt,null,r.a.createElement(Qt,null,r.a.createElement("h1",null,t)),r.a.createElement(Jt,null,r.a.createElement(Gt,null,H(a)),r.a.createElement(E.a.Inline,null,r.a.createElement(St,{videoPlayerRef:m}))),r.a.createElement(Ht.a,{once:!1,onBottomPassed:function(){v&&h(!0)},onBottomPassedReverse:function(){v&&h(!1)}},r.a.createElement(Kt,null)),r.a.createElement(Zt,{isFixed:f},r.a.createElement(ea,null,r.a.createElement($t,null))),r.a.createElement(Xt,{isFixed:f},r.a.createElement(Yt.Player,{fluid:!0,aspectRatio:"16:9",preload:s?"auto":"metadata",ref:m,src:i,startTime:s},r.a.createElement(Yt.BigPlayButton,{position:"center"}),r.a.createElement(Yt.ControlBar,{autoHide:!0},r.a.createElement(Yt.VolumeMenuButton,{vertical:!0}),r.a.createElement(Yt.PlaybackRateMenuButton,{rates:[2,1.5,1,.75],order:6.1})))),r.a.createElement(pt,{transcript:o,handleSeek:x,mediaQueriesMatches:v,query:u}),r.a.createElement(Vt,{minutes:n,scPageUrl:c,transcript:o,votes:l,handleSeek:x,topOffset:v?0:w,mediaQueriesMatches:v}))},aa=function(e){var t=e.id,a=e.query,n=e.videoTimePoint,c=r.a.useState(),i=Object(R.a)(c,2),o=i[0],l=i[1];return qe(o?"".concat(o.name," - ").concat(H(o.date)):"Loading..."),r.a.useEffect((function(){try{!function(){var e;_.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_.a.awrap(_e(t));case 2:e=a.sent,l(e);case 4:case"end":return a.stop()}}))}()}catch(e){}}),[t]),o?r.a.createElement(ta,{id:t,title:o.name,date:o.date,description:o.description,scPageUrl:o.scPageUrl,videoUrl:o.videoUrl,minutes:o.minutes,transcript:o.transcript,votes:o.votes,query:a,videoTimePoint:n}):r.a.createElement($e.a,{active:!0})},na=Object(y.a)(b.a)({minHeight:"100vh"}),ra=Object(y.a)(b.a)({marginTop:"2em !important",marginBottom:"5em !important"}),ca=function(e){var t=e.match,a=e.location,n=U.a.parse(a.search),c=n.q,i=n.t;return r.a.createElement(na,null,r.a.createElement(ra,null,r.a.createElement(aa,{id:t.params.id,query:function(){var e=c?c.trim().replace(/\+/g," "):"";return a.state&&(e=a.state.query||e),e}(),videoTimePoint:!i||isNaN(i)?0:Math.max(0,parseFloat(i))})))},ia=Object(y.a)(b.a)({minHeight:"100vh"}),oa=Object(y.a)(b.a)({marginTop:"2em !important",marginBottom:"5em !important"}),la=function(){return r.a.createElement(ia,null,r.a.createElement(oa,null,r.a.createElement("h2",null,"All Events"),r.a.createElement(Qe,null)))},ua=Object(y.a)("div")({display:"flex",flexWrap:"wrap"}),sa=Object(y.a)("div")({width:"250px",border:"1px solid #d4d4d5",boxShadow:"0 1px 3px 0 #d4d4d5",padding:"1.5rem",marginBottom:"1.5rem",borderRadius:"3px",marginRight:"2rem",cursor:"pointer",transition:".4s all",":hover":{transform:"scale(1.15)"}}),ma=Object(y.a)("h5")({fontWeight:600,fontSize:"1.2rem"}),da=Object(v.h)((function(e){var t=e.people,a=e.history;return r.a.createElement(n.Fragment,null,r.a.createElement("h2",null,"Voting History"),r.a.createElement(ua,null,t.map((function(e){var t=e.full_name,n=e.email,c=e.id;return r.a.createElement(sa,{key:t,onClick:function(){return a.push("/people/".concat(c))}},r.a.createElement(ma,null,t),r.a.createElement("p",null,"City Council Member"),r.a.createElement("a",{href:"mailto:".concat(n)},n))}))))})),pa=function(){var e=Object(n.useState)(null),t=Object(R.a)(e,2),a=t[0],c=t[1];return qe("City Council Members"),Object(n.useEffect)((function(){!function(){var e;_.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,_.a.awrap(Me());case 2:e=t.sent,c(e);case 4:case"end":return t.stop()}}))}()}),[]),a?r.a.createElement(da,{people:a}):r.a.createElement($e.a,{active:!0})},fa=Object(y.a)(b.a)({minHeight:"100vh"}),ha=Object(y.a)(b.a)({marginTop:"2em !important",marginBottom:"5em !important"}),va=function(){return r.a.createElement(fa,null,r.a.createElement(ha,null,r.a.createElement(pa,null)))},Ea=a(845),ba={marginRight:"0.5em"},ya=function(e){var t=e.personHistory,a=t.full_name,c=t.email,i=t.phone,o=t.website,l=t.votes,u=we.a.compact(we.a.uniq(l.map((function(e){return e.voteForPerson})))),s=Object(n.useState)([]),m=Object(R.a)(s,2),d=m[0],p=m[1],f=Object(n.useState)(l),h=Object(R.a)(f,2),v=h[0],b=h[1],y=function(e,t){var a=t.label,n=[];d.includes(a)?(n=we.a.without(d,a),p(n)):(d.push(a),p(n=d)),we.a.isEmpty(n)?b(l):b(we.a.filter(l,(function(e){return n.includes(e.voteForPerson)})))},w=u.map((function(e,t){return r.a.createElement(Ea.a,{style:ba,key:t,label:e,onChange:y})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.a,{as:"h1"},a),r.a.createElement(O.a,{columns:1,stackable:!0},r.a.createElement(O.a.Column,null,r.a.createElement(E.a,null,r.a.createElement(j.a,{as:"h2"},"Contact information"),r.a.createElement("strong",null,"Email:")," ",r.a.createElement("a",{href:"mailto:".concat(c)},c),r.a.createElement("div",null,r.a.createElement("strong",null,"Phone:")," ",i),r.a.createElement("div",null,r.a.createElement("strong",null,"Website:")," ",r.a.createElement("a",{target:"_blank",rel:"noopener noreferrer",href:o},o)))),r.a.createElement(O.a.Column,null,r.a.createElement(E.a,null,r.a.createElement(j.a,{as:"h2"},"Voting record"),r.a.createElement(j.a,{as:"h3"},"Filter by vote cast"),r.a.createElement(q.a,null,w),r.a.createElement(qt,{votingData:v,isPerson:!0})))))},wa=Object(v.h)((function(e){var t=e.match.params.id,a=Object(n.useState)(null),c=Object(R.a)(a,2),i=c[0],o=c[1];return qe(i?i.full_name:"Loading..."),Object(n.useEffect)((function(){!function(){var e;_.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,_.a.awrap(Ne(t));case 2:e=a.sent,o(e);case 4:case"end":return a.stop()}}))}()}),[t]),i?r.a.createElement(ya,{personHistory:i}):r.a.createElement($e.a,{active:!0})})),ga=Object(y.a)(b.a)({minHeight:"100vh"}),xa=Object(y.a)(b.a)({marginTop:"2em !important",marginBottom:"5em !important"}),Oa=function(){return r.a.createElement(ga,null,r.a.createElement(xa,null,r.a.createElement(wa,null)))};o.a.initialize("UA-145893191-1");var ja=function(){return r.a.createElement(h.a,{basename:"/"},r.a.createElement(x,null),r.a.createElement(v.c,null,r.a.createElement(v.a,{exact:!0,path:"/",component:f(M)}),r.a.createElement(v.a,{path:"/search",component:f(Ze)}),r.a.createElement(v.a,{exact:!0,path:"/events",component:f(la)}),r.a.createElement(v.a,{path:"/events/:id",component:f(ca)}),r.a.createElement(v.a,{exact:!0,path:"/people",component:f(va)}),r.a.createElement(v.a,{exact:!0,path:"/people/:id",component:f(Oa)})),r.a.createElement(C,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(ja,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[458,1,2]]]);
//# sourceMappingURL=main.a8bbd026.chunk.js.map